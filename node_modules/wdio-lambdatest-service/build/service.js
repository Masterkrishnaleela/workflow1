"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;
require("source-map-support/register");
var _logger = _interopRequireDefault(require("@wdio/logger"));
var _util = require("./util.js");
var _constants = require("./constants.js");
function _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }
function _defineProperty(e, r, t) { return (r = _toPropertyKey(r)) in e ? Object.defineProperty(e, r, { value: t, enumerable: !0, configurable: !0, writable: !0 }) : e[r] = t, e; }
function _toPropertyKey(t) { var i = _toPrimitive(t, "string"); return "symbol" == typeof i ? i : i + ""; }
function _toPrimitive(t, r) { if ("object" != typeof t || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || "default"); if ("object" != typeof i) return i; throw new TypeError("@@toPrimitive must return a primitive value."); } return ("string" === r ? String : Number)(t); }
const log = (0, _logger.default)('@wdio/lambdatest-service');
const DEFAULT_OPTIONS = {
  setSessionName: true,
  setSessionStatus: true
};
class LambdaRestService {
  constructor(options = {}, capabilities = {}, config = {}) {
    var _this$_config, _this$_config2;
    _defineProperty(this, "_api", void 0);
    _defineProperty(this, "_browser", void 0);
    _defineProperty(this, "_capabilities", void 0);
    _defineProperty(this, "_config", void 0);
    _defineProperty(this, "_failReasons", []);
    _defineProperty(this, "_failures", 0);
    _defineProperty(this, "_failureStatuses", ['failed', 'ambiguous', 'undefined', 'unknown']);
    _defineProperty(this, "_fullTitle", void 0);
    _defineProperty(this, "_isServiceEnabled", true);
    _defineProperty(this, "_options", DEFAULT_OPTIONS);
    _defineProperty(this, "_scenariosThatRan", []);
    _defineProperty(this, "_specsRan", false);
    _defineProperty(this, "_suiteTitle", void 0);
    _defineProperty(this, "_testCnt", 0);
    _defineProperty(this, "_testTitle", void 0);
    _defineProperty(this, "_error", void 0);
    _defineProperty(this, "_ltErrorRemark", void 0);
    _defineProperty(this, "_useScenarioName", void 0);
    _defineProperty(this, "_lambdaCredentials", void 0);
    _defineProperty(this, "_currentTestTitle", void 0);
    this._options = {
      ...DEFAULT_OPTIONS,
      ...options
    };
    this._capabilities = capabilities;
    this._config = config;
    this._testCnt = 0;
    this._failures = 0;
    const strict = Boolean(((_this$_config = this._config) === null || _this$_config === void 0 ? void 0 : _this$_config.cucumberOpts) && ((_this$_config2 = this._config) === null || _this$_config2 === void 0 || (_this$_config2 = _this$_config2.cucumberOpts) === null || _this$_config2 === void 0 ? void 0 : _this$_config2.strict));
    if (strict) {
      this._failureStatuses.push('pending');
    }
  }
  before(caps, specs, browser) {
    this._browser = browser;
    this._scenariosThatRan = [];
  }
  beforeSession(config, capabilities) {
    this._config = {
      ...this._config,
      ...config
    };
    this._capabilities = {
      ...this._capabilities,
      ...capabilities
    };
    const lambdaCredentials = {
      username: this._config.user,
      accessKey: this._config.key,
      isApp: false
    };
    if (this._config.product === 'appAutomation') {
      lambdaCredentials.isApp = true;
    }
    if (this._config.logFile) {
      lambdaCredentials.logFile = this._config.logFile;
    }
    if (this._config.ltErrorRemark === true) {
      this._ltErrorRemark = true;
    }
    if (this._config.useScenarioName === true) {
      this._useScenarioName = true;
    }
    this._isServiceEnabled = lambdaCredentials.username && lambdaCredentials.accessKey;
    this._lambdaCredentials = lambdaCredentials;
  }
  async beforeScenario(world, context) {
    if (this._useScenarioName) {
      var _world$pickle;
      this._testTitle = (world === null || world === void 0 || (_world$pickle = world.pickle) === null || _world$pickle === void 0 ? void 0 : _world$pickle.name) || 'unknown scenario';
    } else if (!this._suiteTitle) {
      var _world$gherkinDocumen, _context$document, _world$pickle2;
      this._suiteTitle = (world === null || world === void 0 || (_world$gherkinDocumen = world.gherkinDocument) === null || _world$gherkinDocumen === void 0 || (_world$gherkinDocumen = _world$gherkinDocumen.feature) === null || _world$gherkinDocumen === void 0 ? void 0 : _world$gherkinDocumen.name) || (context === null || context === void 0 || (_context$document = context.document) === null || _context$document === void 0 || (_context$document = _context$document.feature) === null || _context$document === void 0 ? void 0 : _context$document.name) || (world === null || world === void 0 || (_world$pickle2 = world.pickle) === null || _world$pickle2 === void 0 ? void 0 : _world$pickle2.name) || 'unknown scenario';
    }
    await this.setSessionName(this._testTitle || this._suiteTitle);
  }
  async beforeSuite(suite) {
    this._suiteTitle = suite.title;
    if (suite.title && suite.title !== 'Jasmine__TopLevel__Suite') {
      await this.setSessionName(suite.title);
    }
  }
  async beforeTest(test) {
    if (!this._isServiceEnabled) {
      return;
    }
    if (test && (test === null || test === void 0 ? void 0 : test.parent) !== undefined) {
      this._currentTestTitle = test === null || test === void 0 ? void 0 : test.parent;
      this._currentTestTitle = `${this._currentTestTitle} - ${test === null || test === void 0 ? void 0 : test.title}`;
    } else if (test && (test === null || test === void 0 ? void 0 : test.fullName) !== undefined) {
      this._currentTestTitle = test === null || test === void 0 ? void 0 : test.fullName;
    }
    if (test.title && !this._testTitle) {
      this._testTitle = test.title;
    }
    let suiteTitle = this._suiteTitle;
    if (test.fullName) {
      const testSuiteName = test.fullName;
      if (this._suiteTitle === 'Jasmine__TopLevel__Suite') {
        suiteTitle = testSuiteName;
      } else if (this._suiteTitle) {
        suiteTitle = (0, _util.getParentSuiteName)(this._suiteTitle, testSuiteName);
      }
    }
    await this.setSessionName(suiteTitle, test);
  }
  async beforeFeature(uri, feature) {
    this._suiteTitle = feature.name;
    await this.setSessionName(this._suiteTitle);
  }
  async beforeStep(step) {
    if (!this._suiteTitle || this._suiteTitle == 'unknown scenario') {
      var _step$document, _step$step;
      this._suiteTitle = ((_step$document = step.document) === null || _step$document === void 0 || (_step$document = _step$document.feature) === null || _step$document === void 0 ? void 0 : _step$document.name) || ((_step$step = step.step) === null || _step$step === void 0 || (_step$step = _step$step.scenario) === null || _step$step === void 0 ? void 0 : _step$step.name) || 'unknown scenario';
      await this.setSessionName(this._suiteTitle);
    }
  }
  afterSuite(suite) {
    if (Object.prototype.hasOwnProperty.call(suite, 'error')) {
      ++this._failures;
    }
  }
  afterTest(test, context, {
    error,
    passed
  }) {
    this._specsRan = true;
    if (test._retriedTest && passed) {
      --this._failures;
      return;
    }
    if (test._retriedTest && !passed && typeof test._currentRetry === 'number' && typeof test._retries === 'number' && test._currentRetry < test._retries) {
      return;
    }
    const isJasminePendingError = typeof error === 'string' && error.includes('marked Pending');
    if (!passed && !isJasminePendingError) {
      ++this._failures;
      this._failReasons.push(error && error.message || 'Unknown Error');
      this._error = (error === null || error === void 0 ? void 0 : error.message) || 'Unknown Error';
      if (this._ltErrorRemark && this._error !== null && this._error !== undefined) {
        this._setSessionRemarks(this._error);
      }
    }
  }
  afterScenario(world, result) {
    var _world$result;
    const {
      passed
    } = result || {};
    this._specsRan = true;
    const status = (_world$result = world.result) === null || _world$result === void 0 ? void 0 : _world$result.status.toLowerCase();
    if (status !== 'skipped') {
      this._scenariosThatRan.push(world.pickle.name || 'unknown pickle name');
    }
    if (status && this._failureStatuses.includes(status)) {
      const exception = world.result && world.result.message || (status === 'pending' ? `Some steps/hooks are pending for scenario "${world.pickle.name}"` : 'Unknown Error');
      ++this._failures;
      this._failReasons.push(exception);
    } else if (typeof passed !== 'undefined' && !passed) {
      ++this._failures;
    }
  }
  after(result) {
    if (!this._isServiceEnabled) {
      return;
    }
    let failures = this._failures;
    if (this._config.mochaOpts && this._config.mochaOpts.bail && Boolean(result)) {
      failures = 1;
    }
    if (result === 0) {
      failures = 0;
    }
    const {
      preferScenarioName
    } = this._options;
    if (preferScenarioName && this._scenariosThatRan.length === 1) {
      this._fullTitle = this._scenariosThatRan.pop();
    }
    const status = 'status: ' + (result > 0 ? 'failed' : 'passed');
    if (!this._browser.isMultiremote) {
      log.info(`Update job with sessionId ${this._browser.sessionId}, ${status}`);
      if (process.env.LOG_SESSION_URL === "true") {
        const sessionURL = this.getSessionURL(this._browser.sessionId, this._config.product);
        log.info(`Session URL: ${sessionURL}`);
      }
      return this._update({
        sessionId: this._browser.sessionId,
        failures: result
      });
    }
    return Promise.all(Object.keys(this._capabilities).map(browserName => {
      log.info(`Update multiremote job for browser '${browserName}' and sessionId ${this._browser[browserName].sessionId}, ${status}`);
      if (process.env.LOG_SESSION_URL === "true") {
        const sessionURL = this.getSessionURL(this._browser[browserName].sessionId, this._config.product);
        log.info(`Session URL for ${browserName}: ${sessionURL}`);
      }
      return this._update({
        sessionId: this._browser[browserName].sessionId,
        failures: failures,
        calledOnReload: false,
        browserName: browserName
      });
    }));
  }
  async onReload(oldSessionId, newSessionId) {
    if (!this._isServiceEnabled) {
      return;
    }
    const status = this._failures > 0 ? 'failed' : 'passed';
    if (!this._browser.isMultiremote) {
      log.info(`Update (reloaded) job with sessionId ${oldSessionId}, ${status}`);
      if (process.env.LOG_SESSION_URL === "true") {
        const sessionURL = this.getSessionURL(this._browser.sessionId, this._config.product);
        log.info(`Session URL: ${sessionURL}`);
      }
      await this._update({
        sessionId: oldSessionId,
        fullTitle: this._currentTestTitle,
        status: status,
        calledOnReload: true
      });
    } else {
      const browserName = this._browser.instances.filter(browserName => this._browser[browserName].sessionId === newSessionId)[0];
      log.info(`Update (reloaded) multiremote job for browser '${browserName}' and sessionId ${oldSessionId}, ${status}`);
      if (process.env.LOG_SESSION_URL === "true") {
        const sessionURL = this.getSessionURL(this._browser[browserName].sessionId, this._config.product);
        log.info(`Session URL for ${browserName}: ${sessionURL}`);
      }
      await this._update({
        sessionId: oldSessionId,
        failures: this._failures,
        calledOnReload: true,
        browserName: browserName
      });
    }
    this._failReasons = [];
    this._scenariosThatRan = [];
    delete this._suiteTitle;
    delete this._fullTitle;
  }
  async _update({
    sessionId,
    fullTitle,
    status,
    failures,
    calledOnReload = false,
    browserName
  }) {
    if (!this._options.setSessionStatus) {
      return;
    }
    const sleep = ms => new Promise(r => setTimeout(r, ms));
    await sleep(5000);
    if (calledOnReload) {
      return await this.updateJob({
        sessionId,
        fullTitle,
        status,
        calledOnReload,
        browserName
      });
    }
    return await this.updateJob({
      sessionId,
      _failures: failures,
      calledOnReload,
      browserName
    });
  }
  async updateJob({
    sessionId,
    fullTitle,
    status,
    _failures,
    calledOnReload = false,
    browserName
  }) {
    let body = this.getBody({
      _failures,
      calledOnReload,
      browserName
    });
    if (calledOnReload) {
      body = this.getBody({
        fullTitle,
        status,
        calledOnReload,
        browserName
      });
    }
    try {
      await (0, _util.updateSessionById)(sessionId, body, this._lambdaCredentials);
    } catch (ex) {
      console.log(ex);
    }
    this._failures = 0;
  }
  getBody({
    fullTitle,
    status,
    _failures,
    calledOnReload = false,
    browserName
  }) {
    let body = {};
    if (!(!this._browser.isMultiremote && this._capabilities.name || this._browser.isMultiremote && this._capabilities[browserName].capabilities.name)) {
      body.name = this._fullTitle;
      if (calledOnReload) {
        body.name = fullTitle;
      }
      if (this._capabilities['LT:Options'] && this._capabilities['LT:Options'].name) {
        body.name = this._capabilities['LT:Options'].name;
      }
      if (browserName) {
        body.name = `${browserName}: ${body.name}`;
      }
      if (calledOnReload || this._testCnt) {
        let testCnt = ++this._testCnt;
        if (this._browser.isMultiremote) {
          testCnt = Math.ceil(testCnt / this._browser.instances.length);
        }
        if (!calledOnReload) {
          body.name += ` (${testCnt})`;
        }
      }
    }
    body.status_ind = _failures > 0 ? 'failed' : 'passed';
    if (calledOnReload) {
      body.status_ind = status;
    }
    return body;
  }
  async setSessionName(suiteTitle, test) {
    if (!this._options.setSessionName || !suiteTitle) {
      return;
    }
    let name = this._useScenarioName && this._testTitle ? this._testTitle : suiteTitle;
    if (this._options.sessionNameFormat) {
      name = this._options.sessionNameFormat(this._config, this._capabilities, suiteTitle, test === null || test === void 0 ? void 0 : test.title);
    } else if (test && !test.fullName) {
      const pre = this._options.sessionNamePrependTopLevelSuiteTitle ? `${suiteTitle} - ` : '';
      const post = !this._options.sessionNameOmitTestTitle ? ` - ${test.title}` : '';
      name = `${pre}${test.parent}${post}`;
    }
    if (name !== this.__fullTitle) {
      this.__fullTitle = name;
      await this._setSessionName(name);
    }
  }
  async _setSessionRemarks(err) {
    let replacedString = err.replace(/"/g, "'");
    let errorCustom = `lambda-hook: {"action": "setTestStatus","arguments": {"status":"failed","remark":"${replacedString}"}}`;
    try {
      await this._browser.execute(errorCustom);
    } catch (error) {
      console.log(error);
    }
  }
  async _setSessionName(sessionName) {
    await this._executeCommand(`lambda-name=${sessionName}`);
  }
  async _executeCommand(cmd) {
    if (!this._browser) {
      return;
    }
    if (this._browser.isMultiremote) {
      return Promise.all(Object.keys(this._capabilities).map(async browserName => {
        const browser = this._browser[browserName];
        return await browser.execute(cmd);
      }));
    }
    return await this._browser.execute(cmd);
  }
  getSessionURL(sessionId, product) {
    if (product === 'appAutomation') {
      return `${_constants.appSessionURL}=${sessionId}`;
    }
    return `${_constants.webSessionURL}=${sessionId}`;
  }
}
exports.default = LambdaRestService;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfbG9nZ2VyIiwiX2ludGVyb3BSZXF1aXJlRGVmYXVsdCIsInJlcXVpcmUiLCJfdXRpbCIsIl9jb25zdGFudHMiLCJlIiwiX19lc01vZHVsZSIsImRlZmF1bHQiLCJfZGVmaW5lUHJvcGVydHkiLCJyIiwidCIsIl90b1Byb3BlcnR5S2V5IiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJ2YWx1ZSIsImVudW1lcmFibGUiLCJjb25maWd1cmFibGUiLCJ3cml0YWJsZSIsImkiLCJfdG9QcmltaXRpdmUiLCJTeW1ib2wiLCJ0b1ByaW1pdGl2ZSIsImNhbGwiLCJUeXBlRXJyb3IiLCJTdHJpbmciLCJOdW1iZXIiLCJsb2ciLCJsb2dnZXIiLCJERUZBVUxUX09QVElPTlMiLCJzZXRTZXNzaW9uTmFtZSIsInNldFNlc3Npb25TdGF0dXMiLCJMYW1iZGFSZXN0U2VydmljZSIsImNvbnN0cnVjdG9yIiwib3B0aW9ucyIsImNhcGFiaWxpdGllcyIsImNvbmZpZyIsIl90aGlzJF9jb25maWciLCJfdGhpcyRfY29uZmlnMiIsIl9vcHRpb25zIiwiX2NhcGFiaWxpdGllcyIsIl9jb25maWciLCJfdGVzdENudCIsIl9mYWlsdXJlcyIsInN0cmljdCIsIkJvb2xlYW4iLCJjdWN1bWJlck9wdHMiLCJfZmFpbHVyZVN0YXR1c2VzIiwicHVzaCIsImJlZm9yZSIsImNhcHMiLCJzcGVjcyIsImJyb3dzZXIiLCJfYnJvd3NlciIsIl9zY2VuYXJpb3NUaGF0UmFuIiwiYmVmb3JlU2Vzc2lvbiIsImxhbWJkYUNyZWRlbnRpYWxzIiwidXNlcm5hbWUiLCJ1c2VyIiwiYWNjZXNzS2V5Iiwia2V5IiwiaXNBcHAiLCJwcm9kdWN0IiwibG9nRmlsZSIsImx0RXJyb3JSZW1hcmsiLCJfbHRFcnJvclJlbWFyayIsInVzZVNjZW5hcmlvTmFtZSIsIl91c2VTY2VuYXJpb05hbWUiLCJfaXNTZXJ2aWNlRW5hYmxlZCIsIl9sYW1iZGFDcmVkZW50aWFscyIsImJlZm9yZVNjZW5hcmlvIiwid29ybGQiLCJjb250ZXh0IiwiX3dvcmxkJHBpY2tsZSIsIl90ZXN0VGl0bGUiLCJwaWNrbGUiLCJuYW1lIiwiX3N1aXRlVGl0bGUiLCJfd29ybGQkZ2hlcmtpbkRvY3VtZW4iLCJfY29udGV4dCRkb2N1bWVudCIsIl93b3JsZCRwaWNrbGUyIiwiZ2hlcmtpbkRvY3VtZW50IiwiZmVhdHVyZSIsImRvY3VtZW50IiwiYmVmb3JlU3VpdGUiLCJzdWl0ZSIsInRpdGxlIiwiYmVmb3JlVGVzdCIsInRlc3QiLCJwYXJlbnQiLCJ1bmRlZmluZWQiLCJfY3VycmVudFRlc3RUaXRsZSIsImZ1bGxOYW1lIiwic3VpdGVUaXRsZSIsInRlc3RTdWl0ZU5hbWUiLCJnZXRQYXJlbnRTdWl0ZU5hbWUiLCJiZWZvcmVGZWF0dXJlIiwidXJpIiwiYmVmb3JlU3RlcCIsInN0ZXAiLCJfc3RlcCRkb2N1bWVudCIsIl9zdGVwJHN0ZXAiLCJzY2VuYXJpbyIsImFmdGVyU3VpdGUiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsImFmdGVyVGVzdCIsImVycm9yIiwicGFzc2VkIiwiX3NwZWNzUmFuIiwiX3JldHJpZWRUZXN0IiwiX2N1cnJlbnRSZXRyeSIsIl9yZXRyaWVzIiwiaXNKYXNtaW5lUGVuZGluZ0Vycm9yIiwiaW5jbHVkZXMiLCJfZmFpbFJlYXNvbnMiLCJtZXNzYWdlIiwiX2Vycm9yIiwiX3NldFNlc3Npb25SZW1hcmtzIiwiYWZ0ZXJTY2VuYXJpbyIsInJlc3VsdCIsIl93b3JsZCRyZXN1bHQiLCJzdGF0dXMiLCJ0b0xvd2VyQ2FzZSIsImV4Y2VwdGlvbiIsImFmdGVyIiwiZmFpbHVyZXMiLCJtb2NoYU9wdHMiLCJiYWlsIiwicHJlZmVyU2NlbmFyaW9OYW1lIiwibGVuZ3RoIiwiX2Z1bGxUaXRsZSIsInBvcCIsImlzTXVsdGlyZW1vdGUiLCJpbmZvIiwic2Vzc2lvbklkIiwicHJvY2VzcyIsImVudiIsIkxPR19TRVNTSU9OX1VSTCIsInNlc3Npb25VUkwiLCJnZXRTZXNzaW9uVVJMIiwiX3VwZGF0ZSIsIlByb21pc2UiLCJhbGwiLCJrZXlzIiwibWFwIiwiYnJvd3Nlck5hbWUiLCJjYWxsZWRPblJlbG9hZCIsIm9uUmVsb2FkIiwib2xkU2Vzc2lvbklkIiwibmV3U2Vzc2lvbklkIiwiZnVsbFRpdGxlIiwiaW5zdGFuY2VzIiwiZmlsdGVyIiwic2xlZXAiLCJtcyIsInNldFRpbWVvdXQiLCJ1cGRhdGVKb2IiLCJib2R5IiwiZ2V0Qm9keSIsInVwZGF0ZVNlc3Npb25CeUlkIiwiZXgiLCJjb25zb2xlIiwidGVzdENudCIsIk1hdGgiLCJjZWlsIiwic3RhdHVzX2luZCIsInNlc3Npb25OYW1lRm9ybWF0IiwicHJlIiwic2Vzc2lvbk5hbWVQcmVwZW5kVG9wTGV2ZWxTdWl0ZVRpdGxlIiwicG9zdCIsInNlc3Npb25OYW1lT21pdFRlc3RUaXRsZSIsIl9fZnVsbFRpdGxlIiwiX3NldFNlc3Npb25OYW1lIiwiZXJyIiwicmVwbGFjZWRTdHJpbmciLCJyZXBsYWNlIiwiZXJyb3JDdXN0b20iLCJleGVjdXRlIiwic2Vzc2lvbk5hbWUiLCJfZXhlY3V0ZUNvbW1hbmQiLCJjbWQiLCJhcHBTZXNzaW9uVVJMIiwid2ViU2Vzc2lvblVSTCIsImV4cG9ydHMiXSwic291cmNlcyI6WyIuLi9zcmMvc2VydmljZS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgbG9nZ2VyIGZyb20gJ0B3ZGlvL2xvZ2dlcidcblxuaW1wb3J0IHsgZ2V0UGFyZW50U3VpdGVOYW1lLCB1cGRhdGVTZXNzaW9uQnlJZCB9IGZyb20gJy4vdXRpbC5qcydcbmltcG9ydCB7IGFwcFNlc3Npb25VUkwsIHdlYlNlc3Npb25VUkwgfSBmcm9tICcuL2NvbnN0YW50cy5qcyc7XG5cbmNvbnN0IGxvZyA9IGxvZ2dlcignQHdkaW8vbGFtYmRhdGVzdC1zZXJ2aWNlJylcblxuLyoqIEB0eXBlIHtpbXBvcnQoJy4vdHlwZXMuanMnKS5MVE9wdGlvbnMgJiBpbXBvcnQoJy4vdHlwZXMuanMnKS5TZXNzaW9uTmFtZU9wdGlvbnN9ICovXG5jb25zdCBERUZBVUxUX09QVElPTlMgPSB7XG4gIHNldFNlc3Npb25OYW1lOiB0cnVlLFxuICBzZXRTZXNzaW9uU3RhdHVzOiB0cnVlLFxufTtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgTGFtYmRhUmVzdFNlcnZpY2Uge1xuICBfYXBpO1xuICBfYnJvd3NlcjtcbiAgX2NhcGFiaWxpdGllcztcbiAgX2NvbmZpZztcbiAgX2ZhaWxSZWFzb25zID0gW107XG4gIF9mYWlsdXJlcyA9IDA7XG4gIF9mYWlsdXJlU3RhdHVzZXMgPSBbJ2ZhaWxlZCcsICdhbWJpZ3VvdXMnLCAndW5kZWZpbmVkJywgJ3Vua25vd24nXTtcbiAgX2Z1bGxUaXRsZTtcbiAgX2lzU2VydmljZUVuYWJsZWQgPSB0cnVlO1xuICBfb3B0aW9ucyA9IERFRkFVTFRfT1BUSU9OUztcbiAgX3NjZW5hcmlvc1RoYXRSYW4gPSBbXTtcbiAgX3NwZWNzUmFuID0gZmFsc2U7XG4gIF9zdWl0ZVRpdGxlO1xuICBfdGVzdENudCA9IDA7XG4gIF90ZXN0VGl0bGU7XG4gIF9lcnJvcjtcbiAgX2x0RXJyb3JSZW1hcms7XG4gIF91c2VTY2VuYXJpb05hbWU7XG4gIF9sYW1iZGFDcmVkZW50aWFscztcbiAgX2N1cnJlbnRUZXN0VGl0bGU7XG5cbiAgY29uc3RydWN0b3Iob3B0aW9ucyA9IHt9LCBjYXBhYmlsaXRpZXMgPSB7fSwgY29uZmlnID0ge30pIHtcbiAgICB0aGlzLl9vcHRpb25zID0geyAuLi5ERUZBVUxUX09QVElPTlMsIC4uLm9wdGlvbnMgfTtcbiAgICB0aGlzLl9jYXBhYmlsaXRpZXMgPSBjYXBhYmlsaXRpZXM7XG4gICAgdGhpcy5fY29uZmlnID0gY29uZmlnO1xuICAgIHRoaXMuX3Rlc3RDbnQgPSAwO1xuICAgIHRoaXMuX2ZhaWx1cmVzID0gMDtcbiAgICAvLyBDdWN1bWJlciBzcGVjaWZpY1xuICAgIGNvbnN0IHN0cmljdCA9IEJvb2xlYW4odGhpcy5fY29uZmlnPy5jdWN1bWJlck9wdHMgJiYgdGhpcy5fY29uZmlnPy5jdWN1bWJlck9wdHM/LnN0cmljdCk7XG4gICAgLy8gU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9jdWN1bWJlci9jdWN1bWJlci1qcy9ibG9iL21hc3Rlci9zcmMvcnVudGltZS9pbmRleC50cyNMMTM2XG4gICAgaWYgKHN0cmljdCkge1xuICAgICAgdGhpcy5fZmFpbHVyZVN0YXR1c2VzLnB1c2goJ3BlbmRpbmcnKTtcbiAgICB9XG4gIH1cblxuICBiZWZvcmUoY2Fwcywgc3BlY3MsIGJyb3dzZXIpIHtcbiAgICB0aGlzLl9icm93c2VyID0gYnJvd3NlcjtcbiAgICB0aGlzLl9zY2VuYXJpb3NUaGF0UmFuID0gW107XG4gIH1cblxuICBiZWZvcmVTZXNzaW9uKGNvbmZpZywgY2FwYWJpbGl0aWVzKSB7XG4gICAgdGhpcy5fY29uZmlnID0geyAuLi50aGlzLl9jb25maWcsIC4uLmNvbmZpZyB9O1xuICAgIHRoaXMuX2NhcGFiaWxpdGllcyA9IHsgLi4udGhpcy5fY2FwYWJpbGl0aWVzLCAuLi5jYXBhYmlsaXRpZXMgfTtcbiAgICBjb25zdCBsYW1iZGFDcmVkZW50aWFscyA9IHtcbiAgICAgIHVzZXJuYW1lOiB0aGlzLl9jb25maWcudXNlcixcbiAgICAgIGFjY2Vzc0tleTogdGhpcy5fY29uZmlnLmtleSxcbiAgICAgIGlzQXBwIDogZmFsc2VcbiAgICB9O1xuXG4gICAgaWYgKHRoaXMuX2NvbmZpZy5wcm9kdWN0ID09PSAnYXBwQXV0b21hdGlvbicpIHtcbiAgICAgIGxhbWJkYUNyZWRlbnRpYWxzLmlzQXBwID0gdHJ1ZTtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5fY29uZmlnLmxvZ0ZpbGUpIHtcbiAgICAgIGxhbWJkYUNyZWRlbnRpYWxzLmxvZ0ZpbGUgPSB0aGlzLl9jb25maWcubG9nRmlsZTtcbiAgICB9XG4gICAgaWYodGhpcy5fY29uZmlnLmx0RXJyb3JSZW1hcmsgPT09dHJ1ZSlcbiAgICB7XG4gICAgICB0aGlzLl9sdEVycm9yUmVtYXJrPXRydWU7XG4gICAgfVxuICAgIC8vIEN1Y3VtYmVyIHNwZWNpZmljIG9wdGlvbiB0byBzZXQgdGVzdCBuYW1lIGZyb20gc2NlbmFyaW9cbiAgICBpZih0aGlzLl9jb25maWcudXNlU2NlbmFyaW9OYW1lID09PSB0cnVlKVxuICAgIHtcbiAgICAgIHRoaXMuX3VzZVNjZW5hcmlvTmFtZT10cnVlO1xuICAgIH1cblxuICAgIHRoaXMuX2lzU2VydmljZUVuYWJsZWQgPSBsYW1iZGFDcmVkZW50aWFscy51c2VybmFtZSAmJiBsYW1iZGFDcmVkZW50aWFscy5hY2Nlc3NLZXk7XG4gICAgdGhpcy5fbGFtYmRhQ3JlZGVudGlhbHM9bGFtYmRhQ3JlZGVudGlhbHM7XG4gICAgXG4gIH1cblxuICBhc3luYyBiZWZvcmVTY2VuYXJpbyh3b3JsZCwgY29udGV4dCkge1xuICAgIGlmICh0aGlzLl91c2VTY2VuYXJpb05hbWUpIHtcbiAgICAgIHRoaXMuX3Rlc3RUaXRsZSA9IHdvcmxkPy5waWNrbGU/Lm5hbWUgfHwgJ3Vua25vd24gc2NlbmFyaW8nO1xuICAgIH0gZWxzZSBpZiAoIXRoaXMuX3N1aXRlVGl0bGUpIHtcbiAgICAgIHRoaXMuX3N1aXRlVGl0bGUgPVxuICAgICAgICB3b3JsZD8uZ2hlcmtpbkRvY3VtZW50Py5mZWF0dXJlPy5uYW1lIHx8XG4gICAgICAgIGNvbnRleHQ/LmRvY3VtZW50Py5mZWF0dXJlPy5uYW1lIHx8XG4gICAgICAgIHdvcmxkPy5waWNrbGU/Lm5hbWUgfHxcbiAgICAgICAgJ3Vua25vd24gc2NlbmFyaW8nO1xuICAgIH1cbiAgICBhd2FpdCB0aGlzLnNldFNlc3Npb25OYW1lKHRoaXMuX3Rlc3RUaXRsZSB8fCB0aGlzLl9zdWl0ZVRpdGxlKTtcbiAgfVxuXG4gIGFzeW5jIGJlZm9yZVN1aXRlKHN1aXRlKSB7XG4gICAgdGhpcy5fc3VpdGVUaXRsZSA9IHN1aXRlLnRpdGxlO1xuXG4gICAgaWYgKHN1aXRlLnRpdGxlICYmIHN1aXRlLnRpdGxlICE9PSAnSmFzbWluZV9fVG9wTGV2ZWxfX1N1aXRlJykge1xuICAgICAgYXdhaXQgdGhpcy5zZXRTZXNzaW9uTmFtZShzdWl0ZS50aXRsZSk7XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgYmVmb3JlVGVzdCh0ZXN0KSB7XG4gICAgaWYgKCF0aGlzLl9pc1NlcnZpY2VFbmFibGVkKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgaWYgKHRlc3QgJiYgdGVzdD8ucGFyZW50ICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIHRoaXMuX2N1cnJlbnRUZXN0VGl0bGUgPSB0ZXN0Py5wYXJlbnQ7XG4gICAgICB0aGlzLl9jdXJyZW50VGVzdFRpdGxlID0gYCR7dGhpcy5fY3VycmVudFRlc3RUaXRsZX0gLSAke3Rlc3Q/LnRpdGxlfWA7XG4gIH0gZWxzZSBpZiAodGVzdCAmJiB0ZXN0Py5mdWxsTmFtZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICB0aGlzLl9jdXJyZW50VGVzdFRpdGxlID0gdGVzdD8uZnVsbE5hbWU7XG4gIH1cblxuICAgIGlmICh0ZXN0LnRpdGxlICYmICF0aGlzLl90ZXN0VGl0bGUpIHtcbiAgICAgIHRoaXMuX3Rlc3RUaXRsZSA9IHRlc3QudGl0bGU7XG4gICAgfVxuXG4gICAgbGV0IHN1aXRlVGl0bGUgPSB0aGlzLl9zdWl0ZVRpdGxlO1xuXG4gICAgaWYgKHRlc3QuZnVsbE5hbWUpIHtcbiAgICAgIC8vIEZvciBKYXNtaW5lLCBgc3VpdGUudGl0bGVgIGlzIGBKYXNtaW5lX19Ub3BMZXZlbF9fU3VpdGVgLlxuICAgICAgLy8gVGhpcyB0d2VhayBhbGxvd3MgdXMgdG8gc2V0IHRoZSByZWFsIHN1aXRlIG5hbWUuXG4gICAgICBjb25zdCB0ZXN0U3VpdGVOYW1lID0gdGVzdC5mdWxsTmFtZTtcbiAgICAgIGlmICh0aGlzLl9zdWl0ZVRpdGxlID09PSAnSmFzbWluZV9fVG9wTGV2ZWxfX1N1aXRlJykge1xuICAgICAgICBzdWl0ZVRpdGxlID0gdGVzdFN1aXRlTmFtZTtcbiAgICAgIH0gZWxzZSBpZiAodGhpcy5fc3VpdGVUaXRsZSkge1xuICAgICAgICBzdWl0ZVRpdGxlID0gZ2V0UGFyZW50U3VpdGVOYW1lKHRoaXMuX3N1aXRlVGl0bGUsIHRlc3RTdWl0ZU5hbWUpO1xuICAgICAgfVxuICAgIH1cblxuICAgIGF3YWl0IHRoaXMuc2V0U2Vzc2lvbk5hbWUoc3VpdGVUaXRsZSwgdGVzdCk7XG4gIH1cblxuICBhc3luYyBiZWZvcmVGZWF0dXJlKHVyaSwgZmVhdHVyZSkge1xuICAgIHRoaXMuX3N1aXRlVGl0bGUgPSBmZWF0dXJlLm5hbWU7XG4gICAgYXdhaXQgdGhpcy5zZXRTZXNzaW9uTmFtZSh0aGlzLl9zdWl0ZVRpdGxlKTtcbiAgfVxuXG4gIGFzeW5jIGJlZm9yZVN0ZXAoc3RlcCkge1xuICAgIGlmICghdGhpcy5fc3VpdGVUaXRsZSB8fCB0aGlzLl9zdWl0ZVRpdGxlID09ICd1bmtub3duIHNjZW5hcmlvJykge1xuICAgICAgdGhpcy5fc3VpdGVUaXRsZSA9XG4gICAgICAgIHN0ZXAuZG9jdW1lbnQ/LmZlYXR1cmU/Lm5hbWUgfHxcbiAgICAgICAgc3RlcC5zdGVwPy5zY2VuYXJpbz8ubmFtZSB8fFxuICAgICAgICAndW5rbm93biBzY2VuYXJpbyc7XG4gICAgICBhd2FpdCB0aGlzLnNldFNlc3Npb25OYW1lKHRoaXMuX3N1aXRlVGl0bGUpO1xuICAgIH1cbiAgfVxuXG4gIGFmdGVyU3VpdGUoc3VpdGUpIHtcbiAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHN1aXRlLCAnZXJyb3InKSkge1xuICAgICAgKyt0aGlzLl9mYWlsdXJlcztcbiAgICB9XG4gIH1cblxuICBhZnRlclRlc3QodGVzdCwgY29udGV4dCwgeyBlcnJvciwgcGFzc2VkIH0pIHtcbiAgICB0aGlzLl9zcGVjc1JhbiA9IHRydWU7XG5cbiAgICAvLyByZW1vdmUgZmFpbHVyZSBpZiB0ZXN0IHdhcyByZXRyaWVkIGFuZCBwYXNzZWRcbiAgICAvLyAoTW9jaGEgb25seSlcbiAgICBpZiAodGVzdC5fcmV0cmllZFRlc3QgJiYgcGFzc2VkKSB7XG4gICAgICAtLXRoaXMuX2ZhaWx1cmVzO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8vIGRvbid0IGJ1bXAgZmFpbHVyZSBudW1iZXIgaWYgdGVzdCB3YXMgcmV0cmllZCBhbmQgc3RpbGwgZmFpbGVkXG4gICAgLy8gKE1vY2hhIG9ubHkpXG4gICAgaWYgKFxuICAgICAgdGVzdC5fcmV0cmllZFRlc3QgJiZcbiAgICAgICFwYXNzZWQgJiZcbiAgICAgIChcbiAgICAgICAgdHlwZW9mIHRlc3QuX2N1cnJlbnRSZXRyeSA9PT0gJ251bWJlcicgJiZcbiAgICAgICAgdHlwZW9mIHRlc3QuX3JldHJpZXMgPT09ICdudW1iZXInICYmXG4gICAgICAgIHRlc3QuX2N1cnJlbnRSZXRyeSA8IHRlc3QuX3JldHJpZXNcbiAgICAgIClcbiAgICApIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBjb25zdCBpc0phc21pbmVQZW5kaW5nRXJyb3IgPSB0eXBlb2YgZXJyb3IgPT09ICdzdHJpbmcnICYmIGVycm9yLmluY2x1ZGVzKCdtYXJrZWQgUGVuZGluZycpO1xuICAgIGlmICghcGFzc2VkICYmICFpc0phc21pbmVQZW5kaW5nRXJyb3IpIHtcbiAgICAgICsrdGhpcy5fZmFpbHVyZXM7XG4gICAgICB0aGlzLl9mYWlsUmVhc29ucy5wdXNoKChlcnJvciAmJiBlcnJvci5tZXNzYWdlKSB8fCAnVW5rbm93biBFcnJvcicpXG4gICAgICB0aGlzLl9lcnJvcj1lcnJvcj8ubWVzc2FnZSB8fCAnVW5rbm93biBFcnJvcic7XG4gICAgICBpZiAodGhpcy5fbHRFcnJvclJlbWFyayAmJiB0aGlzLl9lcnJvciAhPT0gbnVsbCAmJiB0aGlzLl9lcnJvciAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHRoaXMuX3NldFNlc3Npb25SZW1hcmtzKHRoaXMuX2Vycm9yKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBhZnRlclNjZW5hcmlvKHdvcmxkLCByZXN1bHQpIHtcbiAgICBjb25zdCB7IHBhc3NlZCB9ID0gcmVzdWx0IHx8IHt9O1xuICAgIHRoaXMuX3NwZWNzUmFuID0gdHJ1ZTtcbiAgICBjb25zdCBzdGF0dXMgPSB3b3JsZC5yZXN1bHQ/LnN0YXR1cy50b0xvd2VyQ2FzZSgpO1xuICAgIGlmIChzdGF0dXMgIT09ICdza2lwcGVkJykge1xuICAgICAgdGhpcy5fc2NlbmFyaW9zVGhhdFJhbi5wdXNoKHdvcmxkLnBpY2tsZS5uYW1lIHx8ICd1bmtub3duIHBpY2tsZSBuYW1lJyk7XG4gICAgfVxuICAgIGlmIChzdGF0dXMgJiYgdGhpcy5fZmFpbHVyZVN0YXR1c2VzLmluY2x1ZGVzKHN0YXR1cykpIHtcbiAgICAgIGNvbnN0IGV4Y2VwdGlvbiA9IChcbiAgICAgICAgKHdvcmxkLnJlc3VsdCAmJiB3b3JsZC5yZXN1bHQubWVzc2FnZSkgfHxcbiAgICAgICAgKHN0YXR1cyA9PT0gJ3BlbmRpbmcnXG4gICAgICAgICAgPyBgU29tZSBzdGVwcy9ob29rcyBhcmUgcGVuZGluZyBmb3Igc2NlbmFyaW8gXCIke3dvcmxkLnBpY2tsZS5uYW1lfVwiYFxuICAgICAgICAgIDogJ1Vua25vd24gRXJyb3InXG4gICAgICAgIClcbiAgICAgIClcbiAgICAgICsrdGhpcy5fZmFpbHVyZXM7XG4gICAgICB0aGlzLl9mYWlsUmVhc29ucy5wdXNoKGV4Y2VwdGlvbilcbiAgICB9IGVsc2UgaWYgKHR5cGVvZiBwYXNzZWQgIT09ICd1bmRlZmluZWQnICYmICFwYXNzZWQpIHtcbiAgICAgICsrdGhpcy5fZmFpbHVyZXM7XG4gICAgfVxuICB9XG5cbiAgYWZ0ZXIocmVzdWx0KSB7XG4gICAgaWYgKCF0aGlzLl9pc1NlcnZpY2VFbmFibGVkKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgbGV0IGZhaWx1cmVzID0gdGhpcy5fZmFpbHVyZXM7XG5cbiAgICAvLyBzZXQgX2ZhaWx1cmVzIGlmIHVzZXIgaGFzIGJhaWwgb3B0aW9uIHNldCBpbiB3aGljaCBjYXNlIGFmdGVyVGVzdCBhbmRcbiAgICAvLyBhZnRlclN1aXRlIGFyZW4ndCBleGVjdXRlZCBiZWZvcmUgYWZ0ZXIgaG9va1xuICAgIGlmICh0aGlzLl9jb25maWcubW9jaGFPcHRzICYmIHRoaXMuX2NvbmZpZy5tb2NoYU9wdHMuYmFpbCAmJiBCb29sZWFuKHJlc3VsdCkpIHtcbiAgICAgIGZhaWx1cmVzID0gMTtcbiAgICB9XG5cbiAgICBpZiAocmVzdWx0ID09PSAwKSB7XG4gICAgICBmYWlsdXJlcyA9IDA7XG4gICAgfVxuXG4gICAgY29uc3QgeyBwcmVmZXJTY2VuYXJpb05hbWUgfSA9IHRoaXMuX29wdGlvbnM7XG4gICAgLy8gRm9yIEN1Y3VtYmVyOiBDaGVja3Mgc2NlbmFyaW9zIHRoYXQgcmFuIChpLmUuIG5vdCBza2lwcGVkKSBvbiB0aGUgc2Vzc2lvblxuICAgIC8vIE9ubHkgMSBTY2VuYXJpbyByYW4gYW5kIG9wdGlvbiBlbmFibGVkID0+IFJlZGVmaW5lIHNlc3Npb24gbmFtZSB0byBTY2VuYXJpbydzIG5hbWVcbiAgICBpZiAocHJlZmVyU2NlbmFyaW9OYW1lICYmIHRoaXMuX3NjZW5hcmlvc1RoYXRSYW4ubGVuZ3RoID09PSAxKSB7XG4gICAgICB0aGlzLl9mdWxsVGl0bGUgPSB0aGlzLl9zY2VuYXJpb3NUaGF0UmFuLnBvcCgpO1xuICAgIH1cblxuICAgIGNvbnN0IHN0YXR1cyA9ICdzdGF0dXM6ICcgKyAocmVzdWx0ID4gMCA/ICdmYWlsZWQnIDogJ3Bhc3NlZCcpO1xuXG4gICAgaWYgKCF0aGlzLl9icm93c2VyLmlzTXVsdGlyZW1vdGUpIHtcbiAgICAgIGxvZy5pbmZvKGBVcGRhdGUgam9iIHdpdGggc2Vzc2lvbklkICR7dGhpcy5fYnJvd3Nlci5zZXNzaW9uSWR9LCAke3N0YXR1c31gKTtcblxuICAgICAgLy8gUHJpbnQgc2Vzc2lvbiBVUkwgZm9yIHNpbmdsZSByZW1vdGUgYnJvd3NlclxuICAgICAgaWYocHJvY2Vzcy5lbnYuTE9HX1NFU1NJT05fVVJMID09PSBcInRydWVcIikge1xuICAgICAgICBjb25zdCBzZXNzaW9uVVJMID0gdGhpcy5nZXRTZXNzaW9uVVJMKHRoaXMuX2Jyb3dzZXIuc2Vzc2lvbklkLCB0aGlzLl9jb25maWcucHJvZHVjdCk7XG4gICAgICAgIGxvZy5pbmZvKGBTZXNzaW9uIFVSTDogJHtzZXNzaW9uVVJMfWApO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gdGhpcy5fdXBkYXRlKHsgc2Vzc2lvbklkOiB0aGlzLl9icm93c2VyLnNlc3Npb25JZCwgZmFpbHVyZXM6IHJlc3VsdCB9KTtcbiAgICB9XG5cbiAgICByZXR1cm4gUHJvbWlzZS5hbGwoT2JqZWN0LmtleXModGhpcy5fY2FwYWJpbGl0aWVzKS5tYXAoYnJvd3Nlck5hbWUgPT4ge1xuICAgICAgbG9nLmluZm8oYFVwZGF0ZSBtdWx0aXJlbW90ZSBqb2IgZm9yIGJyb3dzZXIgJyR7YnJvd3Nlck5hbWV9JyBhbmQgc2Vzc2lvbklkICR7dGhpcy5fYnJvd3Nlclticm93c2VyTmFtZV0uc2Vzc2lvbklkfSwgJHtzdGF0dXN9YCk7XG5cbiAgICAgIC8vIFByaW50IHNlc3Npb24gVVJMIGZvciBlYWNoIHJlbW90ZSBicm93c2VyXG4gICAgICBpZihwcm9jZXNzLmVudi5MT0dfU0VTU0lPTl9VUkwgPT09IFwidHJ1ZVwiKSB7XG4gICAgICAgIGNvbnN0IHNlc3Npb25VUkwgPSB0aGlzLmdldFNlc3Npb25VUkwodGhpcy5fYnJvd3Nlclticm93c2VyTmFtZV0uc2Vzc2lvbklkLCB0aGlzLl9jb25maWcucHJvZHVjdCk7XG4gICAgICAgIGxvZy5pbmZvKGBTZXNzaW9uIFVSTCBmb3IgJHticm93c2VyTmFtZX06ICR7c2Vzc2lvblVSTH1gKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHRoaXMuX3VwZGF0ZSh7IHNlc3Npb25JZDogdGhpcy5fYnJvd3Nlclticm93c2VyTmFtZV0uc2Vzc2lvbklkLCBmYWlsdXJlczogZmFpbHVyZXMsIGNhbGxlZE9uUmVsb2FkOiBmYWxzZSwgYnJvd3Nlck5hbWU6IGJyb3dzZXJOYW1lIH0pO1xuICAgIH0pKTtcbiAgfVxuXG4gIGFzeW5jIG9uUmVsb2FkKG9sZFNlc3Npb25JZCwgbmV3U2Vzc2lvbklkKSB7XG4gICAgaWYgKCF0aGlzLl9pc1NlcnZpY2VFbmFibGVkKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgY29uc3Qgc3RhdHVzID0gKHRoaXMuX2ZhaWx1cmVzID4gMCA/ICdmYWlsZWQnIDogJ3Bhc3NlZCcpO1xuXG4gICAgaWYgKCF0aGlzLl9icm93c2VyLmlzTXVsdGlyZW1vdGUpIHtcbiAgICAgIGxvZy5pbmZvKGBVcGRhdGUgKHJlbG9hZGVkKSBqb2Igd2l0aCBzZXNzaW9uSWQgJHtvbGRTZXNzaW9uSWR9LCAke3N0YXR1c31gKTtcblxuICAgICAgLy8gUHJpbnQgc2Vzc2lvbiBVUkwgZm9yIHNpbmdsZSByZW1vdGUgYnJvd3NlclxuICAgICAgaWYocHJvY2Vzcy5lbnYuTE9HX1NFU1NJT05fVVJMID09PSBcInRydWVcIikge1xuICAgICAgICBjb25zdCBzZXNzaW9uVVJMID0gdGhpcy5nZXRTZXNzaW9uVVJMKHRoaXMuX2Jyb3dzZXIuc2Vzc2lvbklkLCB0aGlzLl9jb25maWcucHJvZHVjdCk7XG4gICAgICAgIGxvZy5pbmZvKGBTZXNzaW9uIFVSTDogJHtzZXNzaW9uVVJMfWApO1xuICAgICAgfVxuXG4gICAgICBhd2FpdCB0aGlzLl91cGRhdGUoeyBzZXNzaW9uSWQ6IG9sZFNlc3Npb25JZCwgZnVsbFRpdGxlOiB0aGlzLl9jdXJyZW50VGVzdFRpdGxlLCBzdGF0dXM6IHN0YXR1cywgY2FsbGVkT25SZWxvYWQ6IHRydWUgfSk7XG5cbiAgICB9IGVsc2Uge1xuICAgICAgY29uc3QgYnJvd3Nlck5hbWUgPSB0aGlzLl9icm93c2VyLmluc3RhbmNlcy5maWx0ZXIoYnJvd3Nlck5hbWUgPT4gdGhpcy5fYnJvd3Nlclticm93c2VyTmFtZV0uc2Vzc2lvbklkID09PSBuZXdTZXNzaW9uSWQpWzBdO1xuICAgICAgbG9nLmluZm8oYFVwZGF0ZSAocmVsb2FkZWQpIG11bHRpcmVtb3RlIGpvYiBmb3IgYnJvd3NlciAnJHticm93c2VyTmFtZX0nIGFuZCBzZXNzaW9uSWQgJHtvbGRTZXNzaW9uSWR9LCAke3N0YXR1c31gKTtcblxuICAgICAgLy8gUHJpbnQgc2Vzc2lvbiBVUkwgZm9yIGVhY2ggcmVtb3RlIGJyb3dzZXJcbiAgICAgIGlmKHByb2Nlc3MuZW52LkxPR19TRVNTSU9OX1VSTCA9PT0gXCJ0cnVlXCIpIHtcbiAgICAgICAgY29uc3Qgc2Vzc2lvblVSTCA9IHRoaXMuZ2V0U2Vzc2lvblVSTCh0aGlzLl9icm93c2VyW2Jyb3dzZXJOYW1lXS5zZXNzaW9uSWQsIHRoaXMuX2NvbmZpZy5wcm9kdWN0KTtcbiAgICAgICAgbG9nLmluZm8oYFNlc3Npb24gVVJMIGZvciAke2Jyb3dzZXJOYW1lfTogJHtzZXNzaW9uVVJMfWApO1xuICAgICAgfVxuXG4gICAgICBhd2FpdCB0aGlzLl91cGRhdGUoeyBzZXNzaW9uSWQgOiBvbGRTZXNzaW9uSWQsIGZhaWx1cmVzOnRoaXMuX2ZhaWx1cmVzLCBjYWxsZWRPblJlbG9hZDogdHJ1ZSwgYnJvd3Nlck5hbWU6IGJyb3dzZXJOYW1lIH0pO1xuICAgIH1cblxuICAgIHRoaXMuX2ZhaWxSZWFzb25zID0gW107XG4gICAgdGhpcy5fc2NlbmFyaW9zVGhhdFJhbiA9IFtdO1xuICAgIGRlbGV0ZSB0aGlzLl9zdWl0ZVRpdGxlO1xuICAgIGRlbGV0ZSB0aGlzLl9mdWxsVGl0bGU7XG4gIH1cblxuICBhc3luYyBfdXBkYXRlKHsgc2Vzc2lvbklkLCBmdWxsVGl0bGUsIHN0YXR1cywgZmFpbHVyZXMsIGNhbGxlZE9uUmVsb2FkID0gZmFsc2UsIGJyb3dzZXJOYW1lIH0pIHtcbiAgICBpZiAoIXRoaXMuX29wdGlvbnMuc2V0U2Vzc2lvblN0YXR1cykge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBjb25zdCBzbGVlcCA9IG1zID0+IG5ldyBQcm9taXNlKHIgPT4gc2V0VGltZW91dChyLCBtcykpO1xuICAgIGF3YWl0IHNsZWVwKDUwMDApO1xuICAgIGlmIChjYWxsZWRPblJlbG9hZCl7XG4gICAgICByZXR1cm4gYXdhaXQgdGhpcy51cGRhdGVKb2IoeyBzZXNzaW9uSWQsIGZ1bGxUaXRsZSwgc3RhdHVzLCBjYWxsZWRPblJlbG9hZCwgYnJvd3Nlck5hbWUgfSk7XG4gICAgfVxuICAgIHJldHVybiBhd2FpdCB0aGlzLnVwZGF0ZUpvYih7IHNlc3Npb25JZCwgX2ZhaWx1cmVzOiBmYWlsdXJlcywgY2FsbGVkT25SZWxvYWQsIGJyb3dzZXJOYW1lIH0pO1xuICBcbiAgfVxuXG4gIGFzeW5jIHVwZGF0ZUpvYih7IHNlc3Npb25JZCwgZnVsbFRpdGxlLCBzdGF0dXMsIF9mYWlsdXJlcywgY2FsbGVkT25SZWxvYWQgPSBmYWxzZSwgYnJvd3Nlck5hbWUgfSkge1xuICAgIFxuICAgIGxldCBib2R5ID0gdGhpcy5nZXRCb2R5KHsgX2ZhaWx1cmVzLCBjYWxsZWRPblJlbG9hZCwgYnJvd3Nlck5hbWUgfSk7XG4gICAgaWYoY2FsbGVkT25SZWxvYWQpe1xuICAgICAgIGJvZHkgPSB0aGlzLmdldEJvZHkoeyBmdWxsVGl0bGUsIHN0YXR1cywgY2FsbGVkT25SZWxvYWQsIGJyb3dzZXJOYW1lIH0pO1xuICAgIH1cbiAgICB0cnkge1xuICAgICAgYXdhaXQgdXBkYXRlU2Vzc2lvbkJ5SWQoc2Vzc2lvbklkLCBib2R5LCB0aGlzLl9sYW1iZGFDcmVkZW50aWFscyk7XG4gICAgfSBjYXRjaCAoZXgpIHtcbiAgICAgIGNvbnNvbGUubG9nKGV4KTtcbiAgICB9XG4gICAgdGhpcy5fZmFpbHVyZXMgPSAwO1xuICB9XG5cbiAgZ2V0Qm9keSh7IGZ1bGxUaXRsZSwgc3RhdHVzLCBfZmFpbHVyZXMsIGNhbGxlZE9uUmVsb2FkID0gZmFsc2UsIGJyb3dzZXJOYW1lIH0pIHtcbiAgICBsZXQgYm9keSA9IHt9O1xuICAgIGlmIChcbiAgICAgICEoXG4gICAgICAgICghdGhpcy5fYnJvd3Nlci5pc011bHRpcmVtb3RlICYmIHRoaXMuX2NhcGFiaWxpdGllcy5uYW1lKSB8fFxuICAgICAgICAodGhpcy5fYnJvd3Nlci5pc011bHRpcmVtb3RlICYmXG4gICAgICAgICAgdGhpcy5fY2FwYWJpbGl0aWVzW2Jyb3dzZXJOYW1lXS5jYXBhYmlsaXRpZXMubmFtZSlcbiAgICAgIClcbiAgICApIHtcbiAgICAgIGJvZHkubmFtZSA9IHRoaXMuX2Z1bGxUaXRsZTtcbiAgICAgIGlmKGNhbGxlZE9uUmVsb2FkKXtcbiAgICAgICAgYm9keS5uYW1lPWZ1bGxUaXRsZTtcbiAgICAgIH1cblxuICAgICAgaWYgKHRoaXMuX2NhcGFiaWxpdGllc1snTFQ6T3B0aW9ucyddICYmIHRoaXMuX2NhcGFiaWxpdGllc1snTFQ6T3B0aW9ucyddLm5hbWUpIHtcbiAgICAgICAgYm9keS5uYW1lID0gdGhpcy5fY2FwYWJpbGl0aWVzWydMVDpPcHRpb25zJ10ubmFtZTtcbiAgICAgIH1cblxuICAgICAgaWYgKGJyb3dzZXJOYW1lKSB7XG4gICAgICAgIGJvZHkubmFtZSA9IGAke2Jyb3dzZXJOYW1lfTogJHtib2R5Lm5hbWV9YDtcbiAgICAgIH1cblxuICAgICAgaWYgKGNhbGxlZE9uUmVsb2FkIHx8IHRoaXMuX3Rlc3RDbnQpIHtcbiAgICAgICAgbGV0IHRlc3RDbnQgPSArK3RoaXMuX3Rlc3RDbnQ7XG5cbiAgICAgICAgaWYgKHRoaXMuX2Jyb3dzZXIuaXNNdWx0aXJlbW90ZSkge1xuICAgICAgICAgIHRlc3RDbnQgPSBNYXRoLmNlaWwodGVzdENudCAvIHRoaXMuX2Jyb3dzZXIuaW5zdGFuY2VzLmxlbmd0aCk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoIWNhbGxlZE9uUmVsb2FkKXtcbiAgICAgICAgICBib2R5Lm5hbWUgKz0gYCAoJHt0ZXN0Q250fSlgO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIGJvZHkuc3RhdHVzX2luZCA9IF9mYWlsdXJlcyA+IDAgPyAnZmFpbGVkJyA6ICdwYXNzZWQnO1xuICAgIGlmIChjYWxsZWRPblJlbG9hZCl7XG4gICAgICBib2R5LnN0YXR1c19pbmQgPSBzdGF0dXM7XG4gICAgfVxuICAgIHJldHVybiBib2R5O1xuICB9XG5cbiAgYXN5bmMgc2V0U2Vzc2lvbk5hbWUoc3VpdGVUaXRsZSwgdGVzdCkge1xuICAgIGlmICghdGhpcy5fb3B0aW9ucy5zZXRTZXNzaW9uTmFtZSB8fCAhc3VpdGVUaXRsZSkge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIGxldCBuYW1lID0gdGhpcy5fdXNlU2NlbmFyaW9OYW1lICYmIHRoaXMuX3Rlc3RUaXRsZSA/IHRoaXMuX3Rlc3RUaXRsZSA6IHN1aXRlVGl0bGU7XG4gICAgaWYgKHRoaXMuX29wdGlvbnMuc2Vzc2lvbk5hbWVGb3JtYXQpIHtcbiAgICAgIG5hbWUgPSB0aGlzLl9vcHRpb25zLnNlc3Npb25OYW1lRm9ybWF0KFxuICAgICAgICAgIHRoaXMuX2NvbmZpZyxcbiAgICAgICAgICB0aGlzLl9jYXBhYmlsaXRpZXMsXG4gICAgICAgICAgc3VpdGVUaXRsZSxcbiAgICAgICAgICB0ZXN0Py50aXRsZVxuICAgICAgKTtcbiAgICB9IGVsc2UgaWYgKHRlc3QgJiYgIXRlc3QuZnVsbE5hbWUpIHtcbiAgICAgIC8vIE1vY2hhXG4gICAgICBjb25zdCBwcmUgPSB0aGlzLl9vcHRpb25zLnNlc3Npb25OYW1lUHJlcGVuZFRvcExldmVsU3VpdGVUaXRsZSA/IGAke3N1aXRlVGl0bGV9IC0gYCA6ICcnO1xuICAgICAgY29uc3QgcG9zdCA9ICF0aGlzLl9vcHRpb25zLnNlc3Npb25OYW1lT21pdFRlc3RUaXRsZSA/IGAgLSAke3Rlc3QudGl0bGV9YCA6ICcnO1xuICAgICAgbmFtZSA9IGAke3ByZX0ke3Rlc3QucGFyZW50fSR7cG9zdH1gO1xuICAgIH1cblxuICAgIGlmIChuYW1lICE9PSB0aGlzLl9fZnVsbFRpdGxlKSB7XG4gICAgICB0aGlzLl9fZnVsbFRpdGxlID0gbmFtZTtcbiAgICAgIGF3YWl0IHRoaXMuX3NldFNlc3Npb25OYW1lKG5hbWUpO1xuICAgIH1cbiAgfVxuXG4gIGFzeW5jIF9zZXRTZXNzaW9uUmVtYXJrcyhlcnIpe1xuICAgIGxldCByZXBsYWNlZFN0cmluZyA9IGVyci5yZXBsYWNlKC9cIi9nLCBcIidcIik7XG4gICAgbGV0IGVycm9yQ3VzdG9tID1gbGFtYmRhLWhvb2s6IHtcImFjdGlvblwiOiBcInNldFRlc3RTdGF0dXNcIixcImFyZ3VtZW50c1wiOiB7XCJzdGF0dXNcIjpcImZhaWxlZFwiLFwicmVtYXJrXCI6XCIke3JlcGxhY2VkU3RyaW5nfVwifX1gO1xuICAgIHRyeSB7XG4gICAgICBhd2FpdCB0aGlzLl9icm93c2VyLmV4ZWN1dGUoZXJyb3JDdXN0b20pO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmxvZyhlcnJvcilcbiAgICB9IFxuICB9XG5cbiAgYXN5bmMgX3NldFNlc3Npb25OYW1lKHNlc3Npb25OYW1lKSB7XG4gICAgYXdhaXQgdGhpcy5fZXhlY3V0ZUNvbW1hbmQoYGxhbWJkYS1uYW1lPSR7c2Vzc2lvbk5hbWV9YCk7XG4gIH1cblxuICBhc3luYyBfZXhlY3V0ZUNvbW1hbmQoY21kKSB7XG4gICAgaWYgKCF0aGlzLl9icm93c2VyKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGlmICh0aGlzLl9icm93c2VyLmlzTXVsdGlyZW1vdGUpIHtcbiAgICAgIHJldHVybiBQcm9taXNlLmFsbChPYmplY3Qua2V5cyh0aGlzLl9jYXBhYmlsaXRpZXMpLm1hcChhc3luYyAoYnJvd3Nlck5hbWUpID0+IHtcbiAgICAgICAgY29uc3QgYnJvd3NlciA9IHRoaXMuX2Jyb3dzZXJbYnJvd3Nlck5hbWVdO1xuICAgICAgICByZXR1cm4gYXdhaXQgYnJvd3Nlci5leGVjdXRlKGNtZCk7XG4gICAgICB9KSk7XG4gICAgfVxuICAgIHJldHVybiBhd2FpdCB0aGlzLl9icm93c2VyLmV4ZWN1dGUoY21kKTtcbiAgfVxuXG4gIGdldFNlc3Npb25VUkwoc2Vzc2lvbklkLCBwcm9kdWN0KSB7XG4gICAgaWYgKHByb2R1Y3QgPT09ICdhcHBBdXRvbWF0aW9uJykge1xuICAgICAgcmV0dXJuIGAke2FwcFNlc3Npb25VUkx9PSR7c2Vzc2lvbklkfWA7XG4gICAgfVxuICAgIHJldHVybiBgJHt3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